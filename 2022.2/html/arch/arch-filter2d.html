<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
<!-- OneTrust Cookies Consent Notice start for xilinx.github.io -->

<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="03af8d57-0a04-47a6-8f10-322fa00d8fc7" ></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice end for xilinx.github.io -->
<!-- Google Tag Manager -->
<script type="text/plain" class="optanon-category-C0002">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5RHQV7');</script>
<!-- End Google Tag Manager -->
  <title>5.3. Accelerator - 2D Filter &mdash; Versal PCIe TRD 2022.2 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5.4. Accelerator - XVDPU" href="arch-xvdpu.html" />
    <link rel="prev" title="5.2. Hardware Architecture of the Platform" href="arch-hw.html" /> 
</head>

<body class="wy-body-for-nav">

<!-- Google Tag Manager -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5RHQV7" height="0" width="0" style="display:none;visibility:hidden" class="optanon-category-C0002"></iframe></noscript>
<!-- End Google Tag Manager --> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
            <a href="../index.html" class="icon icon-home"> Versal PCIe TRD
          </a>
              <div class="version">
                1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../revision.html">1. Revision History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">2. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../run.html">3. Run the Prebuilt Image</a></li>
<li class="toctree-l1"><a class="reference internal" href="../build.html">4. Build an Image</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../arch.html">5. Architecture</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="arch-sw.html">5.1. Software Architecture of the Platform</a></li>
<li class="toctree-l2"><a class="reference internal" href="arch-hw.html">5.2. Hardware Architecture of the Platform</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">5.3. Accelerator - 2D Filter</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#software-architecture">5.3.1. Software Architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hardware-architecture">5.3.2. Hardware Architecture</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="arch-xvdpu.html">5.4. Accelerator - XVDPU</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../known-issues.html">6. Known Issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../support.html">7. Support</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Versal PCIe TRD</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../arch.html"><span class="section-number">5. </span>Architecture</a> &raquo;</li>
      <li><span class="section-number">5.3. </span>Accelerator - 2D Filter</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/arch/arch-filter2d.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="accelerator-2d-filter">
<h1><span class="section-number">5.3. </span>Accelerator - 2D Filter<a class="headerlink" href="#accelerator-2d-filter" title="Permalink to this heading">¶</a></h1>
<p>This chapter provides the hardware and software architecture of the  2D Filter
accelerator integrated into a platform.</p>
<section id="software-architecture">
<h2><span class="section-number">5.3.1. </span>Software Architecture<a class="headerlink" href="#software-architecture" title="Permalink to this heading">¶</a></h2>
<p>The accelerator uses Vitis Video Analytics (VVAS) as a framework to realize tranform and AI-powered
solutions that can easily and seamlessly interface with other GStreamer elements such as video sources and sinks.
VVAS provides a simplified interface to developers, exposing certain API to program the accleration kernel without having to worry
about handeling buffer allocations.</p>
<p><strong>vvas_xfilter</strong> is a generic VVAS infrastructure plugin that interact with the acceleration kernel through a set
of APIs exposed by an acceleration software library corresponding to that kernel.
An accelerator element has one source and one sink pad; vvas_xfilter can consume one temporal input
frame from its source pad, data transform and produce one output frame on its sink pad.
vvas_xfilter plug-in wraps the acceleration software library and prepares the acceleration software library handle (VVASKernel)
to be passed to the core APIs as shown in the figure.</p>
<p>The vvas_xfilter plug-in provide many input properties to config the kerenl. Below are significant</p>
<ul class="simple">
<li><p>kernels-config (mandatory) : Is a path to configuration file in JSON format and contains information required by the kernel, such as path to xclbin, acceleration software library and many more.</p></li>
<li><p>dynamic-config (optional) : configures one or many input parameters of the kernel during runtime, refer to all parameters under config from the JSON file above.</p></li>
</ul>
<p><strong>Acceleration software libraries</strong> :
vvas_xfilter loads the shared acceleration software library, where  acceleration software library controls the
acceleration kernel, like register programming, or any other core logic that is required to implement the transform functions.</p>
<p><strong>vvas_xfilter2d_sw</strong> is a shared acceleration software library that uses OpenCV libraries to perform filter2d computation as a pure software implmentation performed on the APU cores.</p>
<p><strong>vvas_xfilter2d_pl</strong> is a shared acceleration software library that operates on PL-based kernel obtained by high level synthesis (HLS) from  Xilinx Vitis Vision libraries.</p>
<p>below are the examples where VVAS framework is used with an acceleration software library developed for a hard-kernel IP / software library (e.g., OpenCV)</p>
<a class="reference internal image-reference" href="../_images/vvas.jpg"><img alt="VVAS framework for Acclerator Kernels" src="../_images/vvas.jpg" style="width: 1000px;" /></a>
<p>For detailed documentaion of VVAS infrastructure plugins, plugin properties and JSON configuration file refer the below URL
<a class="reference external" href="https://xilinx.github.io/VVAS/index.html">https://xilinx.github.io/VVAS/index.html</a></p>
</section>
<section id="hardware-architecture">
<h2><span class="section-number">5.3.2. </span>Hardware Architecture<a class="headerlink" href="#hardware-architecture" title="Permalink to this heading">¶</a></h2>
<p>A memory-to-memory (M2M) pipeline reads video frames from memory, does certain
processing, and then writes the processed frames back into memory. A block diagram
of the processing pipeline is shown in the following figure.</p>
<a class="reference internal image-reference" href="../_images/2dfilter_hw.jpg"><img alt="2d Filter Processing Pipeline Diagram" src="../_images/2dfilter_hw.jpg" style="width: 500px;" /></a>
<p>The processing pipeline consists of 2D convolution filter in PL along with a data mover (DM).
The memory-to-memory (m2m) processing pipeline with the 2D convolution filter is
generated and integrated by the Vitis™ tool. The C-based 2D filter function is
translated to RTL and then packaged as kernel object (.xo) using Vitis™ HLS.
The Vitis™ tool uses the .xo and integrates the IPs into the platform.</p>
<p>For more information on 2D Convolution filter in PL refer to
<a class="reference external" href="https://xilinx.github.io/Vitis_Libraries/vision/2022.1/overview.html#">Vitis Vision Library: Custom Convolution</a></p>
<p>The data movers read input frames from the memory. The processing block runs
convolution on the frame. Convolution is a common image processing technique that
changes the intensity of a pixel to reflect the intensities of the surrounding pixels.
This is widely used in image filters to achieve popular image effects like blur,
sharpen, and edge detection.</p>
<p>The implemented algorithm uses a 3x3 kernel with programmable filter coefficients.
The coefficients inside the kernel determine how to transform the pixels from
the original image into the pixels of the processed image, as shown in the
following figure.</p>
<a class="reference internal image-reference" href="../_images/filter3x3.jpg"><img alt="2D Convolution Filter with a 3x3 Kernel" src="../_images/filter3x3.jpg" style="width: 1000px;" /></a>
<p>The algorithm performs a two-dimensional (2D) convolution for each pixel of the
input image with a 3x3 kernel. Convolution is the sum of products, one for each
coefficient/source pixel pair. As the reference design is using a 3x3 kernel, in
this case it is the sum of nine products.</p>
<p>The result of this operation is the new intensity value of the center pixel
in the output image. This scheme is repeated for every pixel of the image in
raster-scan order, that is, line-by-line from top-left to bottom-right.
In total, width x height 2D convolution operations are performed to process
the entire image.</p>
<p>The pixel format used in this design is YUYV which is a packed format with 16
bits per pixel. Each pixel can be divided into two 8-bit components: one for
luma (Y), the other for chroma (U/V alternating).</p>
<p>In this implementation, only the Y component is processed by the 2D convolution
filter which is essentially a grayscale image. The reason is that the human eye
is more sensitive to intensity than color. The combined U/Y components which
accounts for the color is merged back into the final output image unmodified.
The processed frame is then written back to memory by the datamover.</p>
<hr class="docutils" />
<p>Licensed under the Apache License, Version 2.0 (the “License”); you may not use this file
except in compliance with the License.</p>
<p>You may obtain a copy of the License at
<a class="reference external" href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>
<p>Unless required by applicable law or agreed to in writing, software distributed under the
License is distributed on an “AS IS” BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
either express or implied. See the License for the specific language governing permissions
and limitations under the License.</p>
</section>
</section>


           </div>
          </div>
          
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
				  
				  <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="arch-hw.html" class="btn btn-neutral float-left" title="5.2. Hardware Architecture of the Platform" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="arch-xvdpu.html" class="btn btn-neutral float-right" title="5.4. Accelerator - XVDPU" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023-2023, Advanced Micro Devices, Inc.
      <span class="lastupdated">Last updated on May 19, 2023.
      </span></p>
  </div>



										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">

													                    <div class="row">
                        <div class="col-xs-24">
                          <p><a target="_blank" href="https://www.amd.com/en/corporate/copyright">Terms and Conditions</a> | <a target="_blank" href="https://www.amd.com/en/corporate/privacy">Privacy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/cookies">Cookie Policy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/trademarks">Trademarks</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/statement-human-trafficking-forced-labor.pdf">Statement on Forced Labor</a> | <a target="_blank" href="https://www.amd.com/en/corporate/competition">Fair and Open Competition</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/amd-uk-tax-strategy.pdf">UK Tax Strategy</a> | <a target="_blank" href="https://docs.xilinx.com/v/u/9x6YvZKuWyhJId7y7RQQKA">Inclusive Terminology</a> | <a href="#cookiessettings" class="ot-sdk-show-settings">Cookies Settings</a></p>
                        </div>
                    </div>
												</div>
											</div>
										</div>
										
</br>


  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>