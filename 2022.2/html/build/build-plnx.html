<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
<!-- OneTrust Cookies Consent Notice start for xilinx.github.io -->

<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="03af8d57-0a04-47a6-8f10-322fa00d8fc7" ></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice end for xilinx.github.io -->
<!-- Google Tag Manager -->
<script type="text/plain" class="optanon-category-C0002">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5RHQV7');</script>
<!-- End Google Tag Manager -->
  <title>4.5. Build the PetaLinux Image &mdash; Versal PCIe TRD 2022.2 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5. Architecture" href="../arch.html" />
    <link rel="prev" title="4.4. Integrate XVDPU and Multiscaler Kernels in the Platform" href="build-xvdpu.html" /> 
</head>

<body class="wy-body-for-nav">

<!-- Google Tag Manager -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5RHQV7" height="0" width="0" style="display:none;visibility:hidden" class="optanon-category-C0002"></iframe></noscript>
<!-- End Google Tag Manager --> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
            <a href="../index.html" class="icon icon-home"> Versal PCIe TRD
          </a>
              <div class="version">
                1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../revision.html">1. Revision History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">2. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../run.html">3. Run the Prebuilt Image</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../build.html">4. Build an Image</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="build-overview.html">4.1. Tool Flow Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="build-pfm.html">4.2. Create the Vitis Platform</a></li>
<li class="toctree-l2"><a class="reference internal" href="build-filter2d.html">4.3. Integrate 2D Filter Kernels in the Platform</a></li>
<li class="toctree-l2"><a class="reference internal" href="build-xvdpu.html">4.4. Integrate XVDPU and Multiscaler Kernels in the Platform</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">4.5. Build the PetaLinux Image</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#prerequisites">4.5.1. Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-flow-tutorial">4.5.2. Build Flow Tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#steps-to-custom-configure-a-petalinux-project-and-build">4.5.2.1. Steps to Custom configure a PetaLinux project and build</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#reference">4.5.3. Reference</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../arch.html">5. Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../known-issues.html">6. Known Issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../support.html">7. Support</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Versal PCIe TRD</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../build.html"><span class="section-number">4. </span>Build an Image</a> &raquo;</li>
      <li><span class="section-number">4.5. </span>Build the PetaLinux Image</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/build/build-plnx.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="build-the-petalinux-image">
<h1><span class="section-number">4.5. </span>Build the PetaLinux Image<a class="headerlink" href="#build-the-petalinux-image" title="Permalink to this heading">¶</a></h1>
<section id="prerequisites">
<h2><span class="section-number">4.5.1. </span>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>PetaLinux Tools 2022.2</p></li>
<li><p>Linux host machine</p></li>
</ul>
</section>
<section id="build-flow-tutorial">
<h2><span class="section-number">4.5.2. </span>Build Flow Tutorial<a class="headerlink" href="#build-flow-tutorial" title="Permalink to this heading">¶</a></h2>
<p><strong>Clone the Reference Design Files:</strong></p>
<p>Skip this  step if the design has already been cloned and
extracted to a working directory</p>
<ol class="arabic">
<li><p>Clone the VCK190 PCIe TRD repository using the following command</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>--branch<span class="w"> </span><span class="m">2022</span>.2<span class="w"> </span>--recursive<span class="w"> </span>https://github.com/Xilinx/vck190-pcie-trd.git
</pre></div>
</div>
</li>
</ol>
<p>The directory structure is described in the Introduction Section.</p>
<p><strong>Generate PetaLinux Image</strong></p>
<p>Petalinux build flow has dependecy on artifacts from Vitis platform and overlay.
Complete the build steps listed in the below sections before generating a bootable petalinux image.</p>
<ul>
<li><p>Section 4.2: <strong>Create the Vitis Platform</strong></p>
<p>Ensure all steps in <a class="reference internal" href="build-pfm.html#create-a-vitis-extensible-platform"><span class="std std-ref">Create the Vitis Platform</span></a> section are executed.</p>
</li>
<li><p>Section 4.3: <strong>Integrate Kernels in the Platform</strong></p>
<p>Ensure all steps in the section <a class="reference internal" href="build-filter2d.html#implement-platform-design-with-filter2d-pl-and-filter2d-aie-accelerators"><span class="std std-ref">Integrate 2D Filter Kernels in the Platform</span></a>
are executed if filter2d is the targeted kernel and/or <a class="reference internal" href="build-xvdpu.html#integrate-xvdpu-overlay"><span class="std std-ref">Integrate XVDPU and Multiscaler Kernels in the Platform</span></a> if xvdpu is the targeted kernel.</p>
</li>
</ul>
<p>The xsa and xclbin binaries produced from the previous step are consumed by
petalinux during the image creation step.</p>
<ol class="arabic">
<li><p>Source the PetaLinux tool settings.sh script.</p></li>
<li><p>Create a bootable SD card image:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make<span class="w"> </span>sdcard<span class="w"> </span><span class="nv">PFM</span><span class="o">=</span>vck190_mipiRxSingle_hdmiTx<span class="w"> </span><span class="nv">OVERLAY</span><span class="o">=</span>filter2d
</pre></div>
</div>
</li>
</ol>
<p>The resulting build artifacts will be available in the <em>images/linux/</em> folder.
The following is a list of important output files:</p>
<ul class="simple">
<li><p><strong>binary_container_1.xclbin</strong>: This is the kernel meta data file used by XRT</p></li>
<li><p><strong>BOOT.BIN</strong>: This is the boot image which includes:</p>
<ul>
<li><p>Platform Loader and Manager (PLM)</p></li>
<li><p>PS Management (PSM) firmware</p></li>
<li><p>Platform Device Image (PDI)</p></li>
<li><p>ARM trusted firmware</p></li>
<li><p>u-boot</p></li>
<li><p>Device tree blob</p></li>
<li><p>Merged AI Engine application and configuration data object (CDO) file</p></li>
</ul>
</li>
<li><p><strong>boot.scr</strong>: A u-boot boot script</p></li>
<li><p><strong>Image</strong>: Linux kernel image</p></li>
<li><p><strong>ramdisk.cpio.gz.u-boot</strong>: Initial filesystem in ramdisk</p></li>
<li><p><strong>rootfs.tar.gz</strong>: Compressed root file system tar ball</p></li>
<li><p><strong>petalinux-sdimage.wic.xz</strong>: Compressed SD card image file in wic format</p></li>
</ul>
<p>The SD card image is now ready to be used to boot the device into Linux, see
Section <a class="reference internal" href="../run.html#run-the-prebuilt-image"><span class="std std-ref">Run the Prebuilt Image</span></a> for details.</p>
<p><strong>Note:</strong>
To generate the SD card image for XVDPU kernel, create a copy of generated filter2d SD card image file,
clean the petalinux project tmp space,
and repeat the steps by replacing <em>filter2d</em> with <em>xvdpu</em> in the make command.</p>
<section id="steps-to-custom-configure-a-petalinux-project-and-build">
<h3><span class="section-number">4.5.2.1. </span>Steps to Custom configure a PetaLinux project and build<a class="headerlink" href="#steps-to-custom-configure-a-petalinux-project-and-build" title="Permalink to this heading">¶</a></h3>
<p>User can configure BSP with custom XSA file, refer to the steps provided in</p>
<p><a class="reference external" href="https://github.com/Xilinx/vck190-pcie-trd/blob/2022.2/petalinux/xilinx-vck190-pcie-trd/README.md">https://github.com/Xilinx/vck190-pcie-trd/blob/2022.2/petalinux/xilinx-vck190-pcie-trd/README.md</a></p>
</section>
</section>
<section id="reference">
<h2><span class="section-number">4.5.3. </span>Reference<a class="headerlink" href="#reference" title="Permalink to this heading">¶</a></h2>
<p>Petalinux Tools Documentation</p>
<p><a class="reference external" href="https://www.xilinx.com/support/documentation/sw_manuals/xilinx2022.2/ug1144-petalinux-tools-reference-guide.pdf">https://www.xilinx.com/support/documentation/sw_manuals/xilinx2022.2/ug1144-petalinux-tools-reference-guide.pdf</a></p>
<hr class="docutils" />
<p>Licensed under the Apache License, Version 2.0 (the “License”); you may not use this file
except in compliance with the License.</p>
<p>You may obtain a copy of the License at
<a class="reference external" href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>
<p>Unless required by applicable law or agreed to in writing, software distributed under the
License is distributed on an “AS IS” BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
either express or implied. See the License for the specific language governing permissions
and limitations under the License.</p>
</section>
</section>


           </div>
          </div>
          
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
				  
				  <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="build-xvdpu.html" class="btn btn-neutral float-left" title="4.4. Integrate XVDPU and Multiscaler Kernels in the Platform" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../arch.html" class="btn btn-neutral float-right" title="5. Architecture" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023-2023, Advanced Micro Devices, Inc.
      <span class="lastupdated">Last updated on May 19, 2023.
      </span></p>
  </div>



										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">

													                    <div class="row">
                        <div class="col-xs-24">
                          <p><a target="_blank" href="https://www.amd.com/en/corporate/copyright">Terms and Conditions</a> | <a target="_blank" href="https://www.amd.com/en/corporate/privacy">Privacy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/cookies">Cookie Policy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/trademarks">Trademarks</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/statement-human-trafficking-forced-labor.pdf">Statement on Forced Labor</a> | <a target="_blank" href="https://www.amd.com/en/corporate/competition">Fair and Open Competition</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/amd-uk-tax-strategy.pdf">UK Tax Strategy</a> | <a target="_blank" href="https://docs.xilinx.com/v/u/9x6YvZKuWyhJId7y7RQQKA">Inclusive Terminology</a> | <a href="#cookiessettings" class="ot-sdk-show-settings">Cookies Settings</a></p>
                        </div>
                    </div>
												</div>
											</div>
										</div>
										
</br>


  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>